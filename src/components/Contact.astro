---
// Contact Component - Fisiodermy
// Usando Web3Forms - GRATIS e ILIMITADO

// Variable de entorno para el API key
const WEB3FORMS_KEY = import.meta.env.PUBLIC_WEB3FORMS_KEY;
---

<section class="contact" id="contacto">
  <div class="container">
    <div class="contact-header animate-on-scroll">
      <p class="section-label centered">Contacto</p>
      <h2 class="contact-title">Agenda tu <em>consulta</em></h2>
      <p class="contact-subtitle">Evaluamos tu caso de forma personalizada y te recomendamos el tratamiento ideal para ti</p>
    </div>
    
    <div class="contact-grid">
      <div class="contact-info animate-on-scroll">
        <div class="contact-details">
          <div class="contact-detail">
            <div class="contact-detail-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
            </div>
            <div class="contact-detail-content">
              <h4>Ubicación</h4>
              <p>Puente Alto, Santiago<br>Región Metropolitana</p>
            </div>
          </div>
          <div class="contact-detail">
            <div class="contact-detail-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72c.127.96.361 1.903.7 2.81a2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0 1 22 16.92z"/>
              </svg>
            </div>
            <div class="contact-detail-content">
              <h4>Teléfono / WhatsApp</h4>
              <p><a href="https://wa.me/56927088372">+56 9 2708 8372</a></p>
            </div>
          </div>
          <div class="contact-detail">
            <div class="contact-detail-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
            </div>
            <div class="contact-detail-content">
              <h4>Horarios</h4>
              <p>Lun - Vie: 9:00 - 19:00<br>Sáb: 9:00 - 14:00</p>
            </div>
          </div>
        </div>
        
       
        
        <!-- Google Map -->
        <div class="contact-map">
          <div class="contact-map-header">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
              <circle cx="12" cy="10" r="3"/>
            </svg>
            <span>Nuestra Ubicación</span>
          </div>
          <div class="contact-map-wrapper">
            <iframe 
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3320.188088349481!2d-70.9227983!3d-33.6781936!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x9662e74e96ddfae1%3A0x4234b6be440acb23!2sFISIODERMY%20CENTRO%20DE%20EST%C3%89TICA%20Y%20DEPILACI%C3%93N%20L%C3%81SER!5e0!3m2!1ses!2scl!4v1766584179691!5m2!1ses!2scl" 
              width="100%" 
              height="300" 
              style="border:0;" 
              allowfullscreen="" 
              loading="lazy" 
              referrerpolicy="no-referrer-when-downgrade"
              title="Ubicación Fisiodermy">
            </iframe>
          </div>
        </div>
        
        <div class="contact-social">
          <h4>Síguenos en redes</h4>
          <div class="social-links">
            <a href="https://www.instagram.com/fisiodermy/" target="_blank" rel="noopener" class="social-link" aria-label="Instagram">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="2" y="2" width="20" height="20" rx="5"/>
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
              </svg>
            </a>
            <a href="https://web.facebook.com/profile.php?id=61555491337373" target="_blank" rel="noopener" class="social-link" aria-label="Facebook">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
      
      <div class="contact-form-wrapper animate-on-scroll">
        <h3>Solicitar Información</h3>
        <p>Completa el formulario y te contactaremos a la brevedad</p>
        
        <form action="https://api.web3forms.com/submit" method="POST" id="contactForm">
          <input type="hidden" name="access_key" value={WEB3FORMS_KEY}>
          <input type="hidden" name="subject" value="Nueva consulta desde Fisiodermy.cl">
          <input type="hidden" name="from_name" value="Fisiodermy Web">
          <input type="hidden" name="redirect" value="https://fisiodermy.cl/#contacto">
          
          <input type="checkbox" name="botcheck" class="hidden" style="display:none">
          
          <div class="form-row">
            <div class="form-group">
              <label for="nombre">Nombre</label>
              <input type="text" id="nombre" name="nombre" placeholder="Tu nombre completo" required>
            </div>
            <div class="form-group">
              <label for="telefono">Teléfono</label>
              <input type="tel" id="telefono" name="telefono" placeholder="+56 9 XXXX XXXX" required>
            </div>
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" placeholder="tu@email.com" required>
          </div>
          <div class="form-group">
            <label for="servicio">Servicio de interés</label>
            <select id="servicio" name="servicio" required>
              <option value="">Seleccionar servicio...</option>
              <option value="Pre Operatorio">Pre Operatorio</option>
              <option value="Post Operatorio">Post Operatorio</option>
              <option value="Rejuvenecimiento Facial">Rejuvenecimiento Facial</option>
              <option value="Peeling Especializado">Peeling Especializado</option>
              <option value="Tratamientos Corporales">Tratamientos Corporales</option>
              <option value="Depilación Láser">Depilación Láser</option>
              <option value="Otro">Otro</option>
            </select>
          </div>
          <div class="form-group">
            <label for="mensaje">Mensaje</label>
            <textarea id="mensaje" name="mensaje" placeholder="Cuéntanos sobre tu caso..."></textarea>
          </div>
          <button type="submit" class="form-submit">Enviar Consulta</button>
        </form>
        
        <!-- Mensaje de éxito -->
        <div class="form-success" id="formSuccess">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
            <polyline points="22 4 12 14.01 9 11.01"/>
          </svg>
          <h4>¡Mensaje enviado!</h4>
          <p>Te contactaremos pronto.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .contact {
    padding: 150px 0;
    background: var(--white-soft);
  }

  .contact-header {
    text-align: center;
    margin-bottom: 80px;
  }

  .contact-title {
    color: var(--black);
    margin-bottom: 15px;
    font-size: 48px;
  }

  .contact-title em {
    font-style: italic;
    color: var(--gold);
  }

  .contact-subtitle {
    font-size: 17px;
    color: var(--gray);
    max-width: 550px;
    margin: 0 auto;
  }

  .contact-grid {
    display: grid;
    grid-template-columns: 1fr 1.2fr;
    gap: 60px;
  }

  .contact-details {
    display: flex;
    flex-direction: column;
    gap: 30px;
    margin-bottom: 40px;
  }

  .contact-detail {
    display: flex;
    align-items: flex-start;
    gap: 20px;
  }

  .contact-detail-icon {
    width: 60px;
    height: 60px;
    background: var(--black);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.4s ease;
  }

  .contact-detail:hover .contact-detail-icon {
    background: var(--gold);
  }

  .contact-detail-icon svg {
    width: 24px;
    height: 24px;
    color: var(--gold);
    transition: color 0.3s ease;
  }

  .contact-detail:hover .contact-detail-icon svg {
    color: var(--black);
  }

  .contact-detail-content h4 {
    font-family: var(--font-body);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--black);
    margin-bottom: 8px;
  }

  .contact-detail-content p {
    font-size: 15px;
    color: var(--gray);
    line-height: 1.6;
  }

  .contact-detail-content a {
    color: var(--gray);
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .contact-detail-content a:hover {
    color: var(--gold);
  }

  .contact-fachada {
    margin-bottom: 30px;
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
  }

  .contact-fachada img {
    width: 100%;
    height: 250px;
    object-fit: cover;
    transition: transform 0.5s ease;
  }

  .contact-fachada:hover img {
    transform: scale(1.05);
  }

  .contact-map {
    background: var(--white);
    overflow: hidden;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
    margin-bottom: 40px;
  }

  .contact-map-header {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 22px 28px;
    background: var(--black);
  }

  .contact-map-header svg {
    width: 22px;
    height: 22px;
    color: var(--gold);
  }

  .contact-map-header span {
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--white);
  }

  .contact-map-wrapper {
    position: relative;
    width: 100%;
    height: 300px;
  }

  .contact-map-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    filter: grayscale(100%) contrast(1.1);
    transition: filter 0.5s ease;
  }

  .contact-map:hover .contact-map-wrapper iframe {
    filter: grayscale(0%) contrast(1);
  }

  .contact-social {
    padding-top: 35px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .contact-social h4 {
    font-family: var(--font-body);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--black);
    margin-bottom: 20px;
  }

  .social-links {
    display: flex;
    gap: 15px;
  }

  .social-link {
    width: 55px;
    height: 55px;
    background: var(--white);
    border: 1px solid rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.4s ease;
  }

  .social-link:hover {
    background: var(--black);
    border-color: var(--black);
    transform: translateY(-5px);
  }

  .social-link svg {
    width: 22px;
    height: 22px;
    color: var(--black);
    transition: color 0.3s ease;
  }

  .social-link:hover svg {
    color: var(--gold);
  }

  .contact-form-wrapper {
    background: var(--white);
    padding: 60px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
    position: relative;
  }

  .contact-form-wrapper::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 5px;
    background: linear-gradient(90deg, var(--gold), var(--gold-light));
  }

  .contact-form-wrapper h3 {
    font-size: 30px;
    color: var(--black);
    margin-bottom: 10px;
  }

  .contact-form-wrapper > p {
    font-size: 15px;
    color: var(--gray);
    margin-bottom: 40px;
  }

  .form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
  }

  .form-group {
    margin-bottom: 25px;
  }

  .form-group label {
    display: block;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--black);
    margin-bottom: 12px;
  }

  .form-group input,
  .form-group select,
  .form-group textarea {
    width: 100%;
    padding: 18px 0;
    font-family: var(--font-body);
    font-size: 15px;
    color: var(--black);
    background: transparent;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.15);
    transition: border-color 0.3s ease;
  }

  .form-group input:focus,
  .form-group select:focus,
  .form-group textarea:focus {
    outline: none;
    border-color: var(--gold);
  }

  .form-group textarea {
    min-height: 100px;
    resize: none;
  }

  .form-submit {
    width: 100%;
    padding: 24px;
    background: var(--black);
    color: var(--white);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    border: none;
    cursor: pointer;
    transition: all 0.4s ease;
  }

  .form-submit:hover {
    background: var(--gold);
    color: var(--black);
  }

  .form-submit:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .form-success {
    display: none;
    text-align: center;
    padding: 60px 40px;
  }

  .form-success.show {
    display: block;
  }

  .form-success svg {
    width: 60px;
    height: 60px;
    color: #25D366;
    margin-bottom: 20px;
  }

  .form-success h4 {
    font-family: var(--font-display);
    font-size: 28px;
    color: var(--black);
    margin-bottom: 10px;
  }

  .form-success p {
    color: var(--gray);
  }

  @media (max-width: 992px) {
    .contact-grid {
      grid-template-columns: 1fr;
      gap: 60px;
    }
  }

  @media (max-width: 768px) {
    .contact-title {
      font-size: 36px;
    }

    .form-row {
      grid-template-columns: 1fr;
    }

    .contact-form-wrapper {
      padding: 40px 30px;
    }
  }
</style>

<script>
  const form = document.getElementById('contactForm') as HTMLFormElement;
  const formSuccess = document.getElementById('formSuccess');
  
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const submitBtn = form.querySelector('button[type="submit"]') as HTMLButtonElement;
    const originalText = submitBtn.textContent;
    submitBtn.textContent = 'Enviando...';
    submitBtn.disabled = true;
    
    try {
      const response = await fetch(form.action, {
        method: 'POST',
        body: new FormData(form),
        headers: {
          'Accept': 'application/json'
        }
      });
      
      const result = await response.json();
      
      if (result.success) {
        form.style.display = 'none';
        formSuccess?.classList.add('show');
      } else {
        throw new Error('Error en el envío');
      }
    } catch (error) {
      alert('Hubo un error al enviar. Por favor intenta de nuevo o contáctanos por WhatsApp.');
      submitBtn.textContent = originalText;
      submitBtn.disabled = false;
    }
  });
</script>